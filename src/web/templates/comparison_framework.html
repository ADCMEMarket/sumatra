{% if records %}
{% load filters %}
<script type = 'text/javascript'>
$(document).ready(function(){
	$('.rcomp').each(function(){
		var min_h = 14;
		var iclass = $(this).attr('class').split(' ')[1]; // not the best way
		$('.rcomp.' + iclass).each(function(){
			var h = $(this).height()
			if (h > min_h) min_h = h; 
		});
		$('.rcomp.' + iclass).css('min-height',min_h);
	});
});
</script>
	   <div style='float:left;width:200px'>
	   	<ol class ='ol-compare'>
	   		<li class='rcomp labl'>Label:</li>
	   		<li class='rcomp reas'>Reason:</li>
	   		<li class='rcomp out'>Outcome:</li>
	   		<li class='rcomp time'>Timestamp:</li>
	   		<li class='rcomp dur'>Duration:</li>
	   		<li class='rcomp exec'>Executable:</li>
	   		<li class='rcomp mode'>Launch mode:</li>
	   		<li class='rcomp repo'>Repository:</li>
	   		<li class='rcomp main'>Main file:</li>
	   		<li class='rcomp vers'>Version:</li>
	   		<li class='rcomp args'>Arguments:</li>
	   		<li class='rcomp tags'>Tags:</li>
	   		<li class='rcomp ifile'>Input files:</li>
	   		<li class='rcomp params'>Parameters:</li>
			<li class='rcomp depend'>Dependencies:</li>
			<li class='rcomp platf'>Platform information:</li>	
			<li class='rcomp stdout'>Stdout & Stderr:</li>
	   	</ol>
	   </div>
   {% for record in records %}
	   <div style='float:left;width:40%'>
	   	<ol class ='ol-compare'>
	   		<li class='rcomp labl' style='background-color:rgb(245, 245, 245);'>{{record.label}}</li>
	   		<li class='rcomp reas'>{{record.reason}}</li>
	   		<li class='rcomp out'>{{record.outcome}}</li>
	   		<li class='rcomp time'>{{record.timestamp|date:"d/m/Y H:i:s"}}</li>
	   		<li class='rcomp dur'>{{record.duration|human_readable_duration}}</li>
	   		<li class='rcomp exec'>{{record.executable.name}} version {{record.executable.version}} ({{record.executable.path}})</li>
	   		<li class='rcomp mode'>{% ifequal record.launch_mode.type "SerialLaunchMode" %}serial{% else %}distributed, n={{record.launch_mode.get_parameters.n}}{% endifequal %}</li>
	   		<li class='rcomp repo'>{{record.repository.url}}</li>
	   		<li class='rcomp main'>{{record.main_file}}</li>
	   		<li class='rcomp vers'>{{record.version}}{% if record.diff %}* (<a href="diff/">diff</a>){% endif %}</li>
	   		<li class='rcomp args'><pre>{{record.script_arguments}}</pre></li>
	   		<li class='rcomp tags'>{{record.tags}}</li>
	   		<li class='rcomp ifile'>
	   			{% if record.input_data.count %}
					<table>
	                    <tr><td colspan="4">{{record.input_datastore.access_parameters.root}}</td></tr>
	                    {% for file in record.input_data.all %}
	                           <tr class="{% cycle odd even %}"><td><a href="datafile?path={{file.path}}&digest={{file.digest}}&type=input">{{file.path}}</a></td>
	                           <td>{{file.digest}}</td>
	                           <td>{{file.metadata.mimetype|default:""}}</td>
	                           <td>{{file.metadata.size|filesizeformat}}</td></tr>
	                    {% endfor %}
	                </table>
	   			{% else %}
                    no input files
                {% endif %}
	   		</li>
	   		<li class='rcomp params'>
                {% if parameters %}
                    {% for name, value in parameters.items %}
                    {{name}} = {{value}}<br>{% endfor %}
                {% else %}
                    no parameters
                {% endif %}
	   		</li>
	   		<li class='rcomp depend'>
	   			{% if record.dependencies.all %}
	   			<table class='table-recDetail'>
                    <tr><th>Name</th><th>Path</th><th>Version</th></tr>
                    {% for dep in record.dependencies.all %}
                    <tr class="{% cycle 'odd' 'even' %}"><td>{{dep.name}}</td><td>{{dep.path}}</td><td>{{dep.version}}{% if dep.diff %}* (<a href="diff/{{dep.name}}">diff</a>){% endif %}</td></tr>{% endfor %}
                </table>
                {% else %}
                	no dependencies
                {% endif %}
	   		</li>
	   		<li class='rcomp platf'>
	   		  {% for platform in record.platforms.all %}
			   	<ol>
			   		<li><span class='platf-t'>Name:</span> {{platform.network_name}}</li>
			   		<li><span class='platf-t'>IP address:</span> {{platform.ip_addr}}</li>
			   		<li><span class='platf-t'>Processor:</span> {{platform.processor}} {{platform.machine}}</li>
			   		<li><span class='platf-t'>Architecture:</span> {{platform.architecture_bits}}</li>
			   		<li><span class='platf-t'>System type:</span> {{platform.system_name}}</li>
			   		<li><span class='platf-t'>Release:</span> {{platform.release}}</li>
			   		<li><span class='platf-t'>Version:</span> {{platform.version}}</li>
			   	</ol>
			   {% endfor %}
	   		</li>
			<li class='rcomp stdout'>
	   		    {% if record.stdout_stderr %}
                <div>
                    <pre>
                    {{ record.stdout_stderr }}
                    </pre>
                </div>
                {% else %}
                no outputs
                {% endif %}
			</li>
	   	</ol>
	   </div>	
   {% endfor %}
{% endif %}

   